function NoGPSMap(){var e=null,t=!1,i=null,a=!1;Ti.Platform.Android.API_LEVEL<=10?t=!0:e=require("ti.map");var o=null,r=null,n=null,s=null,l=Titanium.UI.createWindow({width:"100%",heigth:"100%"});if(!t){var u=e.isGooglePlayServicesAvailable();switch(u){case e.SUCCESS:Ti.API.info("Google Play services is installed.");break;case e.SERVICE_MISSING:alert("Google Play services is missing. Please install Google Play services from the Google Play store.");break;case e.SERVICE_VERSION_UPDATE_REQUIRED:alert("Google Play services is out of date. Please update Google Play services.");break;case e.SERVICE_DISABLED:alert("Google Play services is disabled. Please enable Google Play services.");break;case e.SERVICE_INVALID:alert("Google Play services cannot be authenticated. Reinstall Google Play services.");break;default:alert("Unknown error.")}}l.activity.onCreateOptionsMenu=function(e){var t=l.activity.actionBar;t.title="";var i=e.menu;o=i.add({title:"Ok",icon:Titanium.App.Android.R.drawable.ic_action_check,showAsAction:Ti.Android.SHOW_AS_ACTION_IF_ROOM,visible:!1});var u=i.add({title:"Chiudi",icon:Titanium.App.Android.R.drawable.ic_action_cross,showAsAction:Ti.Android.SHOW_AS_ACTION_IF_ROOM});o.addEventListener("click",function(){a||r.setButtonTitle("Mappa"),Ti.App.fireEvent("position_by_map",{latitude:n,longitude:s}),l.close()}),u.addEventListener("click",function(){r.setButtonTitle(a?"Invia":"Mappa"),l.close()})},l.addEventListener("androidback",function(){var e=Titanium.Android.currentActivity;e.finish(),l.close()});var c=(Titanium.UI.createView({backgroundColor:"#f8f8f8",width:"100%",height:"100%",layout:"vertical"}),Ti.UI.createView({backgroundColor:"#f8f8f8",width:"100%",height:"100%",layout:"horizontal"})),d=Ti.UI.createSwitch({style:Ti.UI.Android.SWITCH_STYLE_CHECKBOX,title:"Non mostrare più.",top:0,left:0});c.add(d);var g=Ti.UI.createAlertDialog({message:"Scegli la tua posizione attuale. Fai uno zoom il più preciso possibile tramite i tasti + e -, e tieni premuto a lungo per posizionare il pin.",ok:"Ok",title:"saveHer",androidView:c});if(g.addEventListener("click",function(){d.getValue()&&Titanium.App.Properties.setInt("showMapDialog",1)}),t){var p=require("/ui/pages/WebMap");i=new p}else{var m=e.createAnnotation({title:"La tua posizione",draggable:!0,animate:!0,showInfoWindow:!0,isAdded:!1});i=e.createView({mapType:e.NORMAL_TYPE,width:"100%",height:"100%",animate:!0,regionFit:!1,userLocation:!1}),i.addEventListener("longclick",function(e){Ti.API.info("lat:"+e.latitude+", lon:"+e.longitude),m.latitude=e.latitude,m.longitude=e.longitude,n=e.latitude,s=e.longitude,i.addAnnotation(m),m.isAdded=!0,o.setVisible(!0)})}return l.openWin=function(e,t,i,a){l.open(),e.remove(t),i.enabled=!0,r=a;var o=Titanium.App.Properties.getInt("showMapDialog");switch(o){case 0:g.show();break;case 1:break;default:g.show()}},l.openWin2=function(e,t,i,o){l.open(),e.remove(t),o.enabled=!0,r=i,a=!0;var n=Titanium.App.Properties.getInt("showMapDialog");switch(n){case 0:g.show();break;case 1:break;default:g.show()}},Ti.App.addEventListener("web_map_pin",function(e){n=e.coords.k,s=e.coords.B,o.setVisible(!0),Ti.API.info(n+","+s)}),l.add(i),l}module.exports=NoGPSMap;