function PickerPopup(e,t,a){var i=null,o=t,r="",n=-1,l=a,u=null,c=null,d=null,s=null;if(i=Ti.UI.createWindow({backgroundColor:"white",layout:"vertical"}),!l){var f=Titanium.UI.create2DMatrix();f=f.scale(0),i.fullscreen=!1,i.top=25,i.backgroundColor="transparent",i.width=Ti.UI.FILL,i.height=Ti.UI.SIZE,i.opacity=1,i.navBarHidden=!0,i.bottom=25}c=Ti.UI.createButton({title:L("cancel"),height:25,top:2,left:20}),d=Ti.UI.createButton({title:L("selected"),height:25,top:2,right:20});var p=Ti.UI.createButton({systemButton:Ti.UI.iPhone.SystemButton.FLEXIBLE_SPACE});s=Ti.UI.iOS.createToolbar({items:[c,p,d],backgroundColor:"#777",top:0,borderTop:!1,borderBottom:!0}),l&&i.add(s);for(var v=[],g=!1,h=0,m=0;m<o.length;m++)"exclude"==o[m].value&&(g=!0,h++),"exclude"!=o[m].value&&v.push({title:o[m].title});var T=Ti.UI.createView({left:0,right:0,bottom:0,height:Ti.UI.FILL});u=Ti.UI.createTableView({data:v,borderWidth:1,borderColor:"#000",borderRadius:5,left:5,right:5,allowSelection:!0,height:Ti.UI.SIZE});var b;return u.addEventListener("click",function(e){l?e.row.hasCheck?(e.row.hasCheck=!1,e.row.backgroundColor="white"):(e.row.hasCheck=!0,e.row.backgroundColor="#ff6600"):(e.row.backgroundColor="#ff6600",e.row.hasCheck=!0,b&&b!=e.row&&(b.hasCheck=!1,b.backgroundColor="white")),i.xsetValue(g?o[e.index+h]:o[e.index]),l||(b=e.row,i.fireEvent("done",{value:r}),i.close())}),i.add(T),T.add(u),d.addEventListener("click",function(){i.fireEvent("done",{value:r}),i.close()}),c.addEventListener("click",function(){i.close()}),i.xsetValue=function(e){n>-1&&u.deselectRow(n);for(var t=0;t<o.length;t++)if(o[t].title==e){n=t,u.selectRow(n),u.scrollToIndex(n);break}r=e},i}function Combobox(e){var t=null,a=null,i=[],o="",r=!1,n=[],l="",u=null,c=L("select"),d=null,s="true",f={};e.labelSelect?c=e.labelSelect:"boolean"==typeof e.labelSelect&&(e.labelSelect||(s=e.labelSelect));var p={title:c,value:"exclude"};for(var v in e)"values"!=v?"title"!=v?f[v]=e[v]:l=e[v]:(s&&e[v].unshift(p),i=e[v]);e.multiple&&(r=e.multiple),i.length>0&&("number"==typeof e.selectedValueIndex?o=i[e.selectedValueIndex]:s&&(o=i[0]));for(var g=0,h=0;h<i.length;h++)n.push(Ti.UI.createPickerRow({title:i[h].title,data:i[h]})),"exclude"!=i[h].value&&g++;if("android"===Ti.Platform.osname)"undefined"!=typeof f.backgroundColor&&delete f.backgroundColor,t=Ti.UI.createPicker(f),t.addEventListener("change",function(e){o=e.selectedValue[0],t.fireEvent("TwChange",{value:t.getSelectedRow(0).data.value})}),t.add(n);else{"undefined"==typeof f.height&&(f.height=35),"undefined"==typeof f.borderColor&&(f.borderColor="#999"),"undefined"==typeof f.borderRadius&&(f.borderRadius=5),"undefined"==typeof f.backgroundColor&&(f.backgroundColor="#fff"),"undefined"==typeof f.font&&(f.font={fontSize:30,fontWeight:"bold"}),"undefined"==typeof f.color&&(f.color="#385487"),t=Ti.UI.createView(f);var m={left:"10dp",top:"11dp",color:f.color,font:f.font,text:o.title,data:o};a=Ti.UI.createLabel(m);var T=Ti.UI.create2DMatrix();d=Ti.UI.createButton({right:5,style:Ti.UI.iPhone.SystemButton.DISCLOSURE,transform:T,backgroundImage:"/widget/arrow.png"}),0==g&&(a.text="Sin Informacion"),t.add(a),t.add(d),t.addEventListener("click",function(){g>0&&(u=new PickerPopup(l,i,r),u.addEventListener("done",function(e){e.value!=o&&(o=e.value,a.text=o.title,a.data=o,e.data=a.data,t.fireEvent("TwChange",e))}),u.xsetValue(o),u.backgroundColor="rgba(51, 204, 255, 0.28)",u.open())})}return t.xgetValue=function(){return o},t.xsetValue=function(e){for(var r=0;r<i.length;r++)i[r].title==e&&(o=e,"android"===Ti.Platform.osname=="android"?t.setSelectedRow(0,r,!1):(a.text=o,a.data=i[r]))},t}var Tw=null;Combobox.TUInit=function(e){Tw=e},module.exports=Combobox;