function FirstPage(){var e=require("ui/handheld/ui_elements/Buttons"),t=require("ui/handheld/rectangles/SmallRectangleWizard1"),i=require("ui/handheld/rectangles/SmallRectangleWizard2"),a=new i,o=require("ui/handheld/rectangles/NicknameRectangle"),r=new o,n=Titanium.UI.createScrollView({backgroundColor:"#eeeeee",width:"100%",height:"100%",layout:"vertical"}),s=Titanium.UI.createLabel({text:"saveHer",font:{fontSize:40,fontFamily:"CaviarDreams"},color:"#6f6f6f",top:10}),l=Titanium.UI.createLabel({text:"Benvenuto in saveHer. Con questa applicazione è possibile salvaguardare i monumenti che stai visitando inviando una segnalazione ai nostri server.",font:{fontSize:20,fontFamily:"CaviarDreams"},color:"#6f6f6f",textAlign:"center",top:15,width:"95%"}),c=Titanium.UI.createLabel({text:"Se è la prima volta che utilizzi saveHer, inizia la procedura guidata di registrazione.",font:{fontSize:20,fontFamily:"CaviarDreams"},color:"#6f6f6f",textAlign:"center",top:15,width:"95%"}),d=Titanium.UI.createLabel({text:"Altrimenti, ripristina il tuo profilo inserendo il nickname con il quale ti sei registrato e premi poi il pulsante Ripristina.",font:{fontSize:20,fontFamily:"CaviarDreams"},color:"#6f6f6f",textAlign:"center",top:15,width:"95%"}),u=Titanium.UI.createLabel({text:"Hai già utilizzato saveHer su questo dispositivo. Se il tuo nickname compare nella lista sottostante, sceglilo direttamente e ripristina il tuo profilo.",font:{fontSize:17,fontFamily:"CaviarDreams"},color:"#6f6f6f",textAlign:"center",top:15,width:"90%"}),f=Titanium.Network.createHTTPClient({onload:function(){var e=JSON.parse(this.responseText);if(e.registered){var t="";Ti.App.Properties.setInt("wizard",1),Ti.App.Properties.setString("mail",e.mail),Ti.App.Properties.setString("first_name",e.name),Ti.App.Properties.setString("last_name",e.lastname),Ti.App.Properties.setString("picture",e.photo),Ti.App.Properties.getString("login_type",e.social),""!=a.getFieldValue()?(Ti.App.Properties.setString("nickname",a.getFieldValue()),t=a.getFieldValue()):(Ti.App.Properties.setString("nickname",r.getNickname()),t=r.getNickname()),saveHer.stopExecution=!1;var i=Titanium.Filesystem.getFile("appdata://","pastUser.txt");if(i.exists()){var o=i.read().toString();-1==o.indexOf(t)&&i.write(t+";",!0)}else i.write(t+";",!0);saveHer.stopExecution=!1,h.setButtonTitle("Ripristina"),Ti.App.fireEvent("goto_app",{})}else{{Ti.UI.createAlertDialog({message:"Non è stato trovato nessun nickname che corrisponda a ciò che hai immesso. Per favore, controlla le tue credenziali.",ok:"Ok",title:"saveHer"}).show()}saveHer.stopExecution=!1,h.setButtonTitle("Ripristina")}},onerror:function(){Ti.UI.createAlertDialog({message:"Non è stato possibile effettuare la richiesta. Riprova, per favore.",ok:"Ok",title:"saveHer"}).show();saveHer.stopExecution=!1,h.setButtonTitle("Ripristina")},timeout:5e3}),h=new e;h.setButtonTitle("Ripristina"),h.setButtonTop(30),h.addEventListener("click",function(){if(!saveHer.stopExecution){if(saveHer.stopExecution=!0,!Ti.Network.getOnline()){{Ti.UI.createAlertDialog({message:"Per poter ripristinare le tue informazioni, per favore connetti il tuo dispositivo alla rete.",ok:"Ok",title:"saveHer"}).show()}return saveHer.stopExecution=!1,void h.setButtonTitle("Ripristina")}if(h.setButtonTitle("Attendi..."),""==a.getFieldValue()&&""==r.getNickname()){{Ti.UI.createAlertDialog({message:"Per poter ripristinare le tue informazioni, per favore inserisci il tuo nickname o sceglilo dal menù a tendina.",ok:"Ok",title:"saveHer"}).show()}return saveHer.stopExecution=!1,void h.setButtonTitle("Ripristina")}if(""!=a.getFieldValue()&&""!=r.getNickname()){{Ti.UI.createAlertDialog({message:"Per poter ripristinare le tue informazioni, per favore scegli se digitare il nickname o recuperarlo dal menù a tendina.",ok:"Ok",title:"saveHer"}).show()}return saveHer.stopExecution=!1,void h.setButtonTitle("Ripristina")}h.setButtonTitle("Attendi...");var e={nick:""};e.nick=""!=a.getFieldValue()?a.getFieldValue():r.getNickname(),Ti.API.info(e.nick),f.open("POST","http://www.appsaveheritage.com/restore.php"),f.send(e)}});var p=Titanium.UI.createView({width:1,height:20,backgroundColor:"transparent"});return n.add(s),n.add(l),n.add(c),n.add(new t),n.add(d),n.add(a),Ti.API.info(r.getNicknamesList()),0!=r.getNicknamesList()&&(n.add(u),n.add(r)),n.add(h),n.add(p),n}module.exports=FirstPage;