function PickerPopup(e,t,i){var a=null,o=t,r="",n=-1,s=i,l=null,c=null,d=null,u=null;if(a=Ti.UI.createWindow({backgroundColor:"white",layout:"vertical"}),!s){var f=Titanium.UI.create2DMatrix();f=f.scale(0),a.fullscreen=!1,a.top=25,a.backgroundColor="transparent",a.width=Ti.UI.FILL,a.height=Ti.UI.SIZE,a.opacity=1,a.navBarHidden=!0,a.bottom=25}c=Ti.UI.createButton({title:L("cancel"),height:25,top:2,left:20}),d=Ti.UI.createButton({title:L("selected"),height:25,top:2,right:20});var h=Ti.UI.createButton({systemButton:Ti.UI.iPhone.SystemButton.FLEXIBLE_SPACE});u=Ti.UI.iOS.createToolbar({items:[c,h,d],backgroundColor:"#777",top:0,borderTop:!1,borderBottom:!0}),s&&a.add(u);for(var p=[],g=!1,m=0,T=0;T<o.length;T++)"exclude"==o[T].value&&(g=!0,m++),"exclude"!=o[T].value&&p.push({title:o[T].title});var v=Ti.UI.createView({left:0,right:0,bottom:0,height:Ti.UI.FILL});l=Ti.UI.createTableView({data:p,borderWidth:1,borderColor:"#000",borderRadius:5,left:5,right:5,allowSelection:!0,height:Ti.UI.SIZE});var w;return l.addEventListener("click",function(e){s?e.row.hasCheck?(e.row.hasCheck=!1,e.row.backgroundColor="white"):(e.row.hasCheck=!0,e.row.backgroundColor="#ff6600"):(e.row.backgroundColor="#ff6600",e.row.hasCheck=!0,w&&w!=e.row&&(w.hasCheck=!1,w.backgroundColor="white")),a.xsetValue(g?o[e.index+m]:o[e.index]),s||(w=e.row,a.fireEvent("done",{value:r}),a.close())}),a.add(v),v.add(l),d.addEventListener("click",function(){a.fireEvent("done",{value:r}),a.close()}),c.addEventListener("click",function(){a.close()}),a.xsetValue=function(e){n>-1&&l.deselectRow(n);for(var t=0;t<o.length;t++)if(o[t].title==e){n=t,l.selectRow(n),l.scrollToIndex(n);break}r=e},a}function Combobox(e){var t=null,i=null,a=[],o="",r=!1,n=[],s="",l=null,c=L("select"),d=null,u="true",f={};e.labelSelect?c=e.labelSelect:"boolean"==typeof e.labelSelect&&(e.labelSelect||(u=e.labelSelect));var h={title:c,value:"exclude"};for(var p in e)"values"!=p?"title"!=p?f[p]=e[p]:s=e[p]:(u&&e[p].unshift(h),a=e[p]);e.multiple&&(r=e.multiple),a.length>0&&("number"==typeof e.selectedValueIndex?o=a[e.selectedValueIndex]:u&&(o=a[0]));for(var g=0,m=0;m<a.length;m++)n.push(Ti.UI.createPickerRow({title:a[m].title,data:a[m]})),"exclude"!=a[m].value&&g++;if("android"===Ti.Platform.osname)"undefined"!=typeof f.backgroundColor&&delete f.backgroundColor,t=Ti.UI.createPicker(f),t.addEventListener("change",function(e){o=e.selectedValue[0],t.fireEvent("TwChange",{value:t.getSelectedRow(0).data.value})}),t.add(n);else{"undefined"==typeof f.height&&(f.height=35),"undefined"==typeof f.borderColor&&(f.borderColor="#999"),"undefined"==typeof f.borderRadius&&(f.borderRadius=5),"undefined"==typeof f.backgroundColor&&(f.backgroundColor="#fff"),"undefined"==typeof f.font&&(f.font={fontSize:30,fontWeight:"bold"}),"undefined"==typeof f.color&&(f.color="#385487"),t=Ti.UI.createView(f);var T={left:"10dp",top:"11dp",color:f.color,font:f.font,text:o.title,data:o};i=Ti.UI.createLabel(T);var v=Ti.UI.create2DMatrix();d=Ti.UI.createButton({right:5,style:Ti.UI.iPhone.SystemButton.DISCLOSURE,transform:v,backgroundImage:"/widget/arrow.png"}),0==g&&(i.text="Sin Informacion"),t.add(i),t.add(d),t.addEventListener("click",function(){g>0&&(l=new PickerPopup(s,a,r),l.addEventListener("done",function(e){e.value!=o&&(o=e.value,i.text=o.title,i.data=o,e.data=i.data,t.fireEvent("TwChange",e))}),l.xsetValue(o),l.backgroundColor="rgba(51, 204, 255, 0.28)",l.open())})}return t.xgetValue=function(){return o},t.xsetValue=function(e){for(var r=0;r<a.length;r++)a[r].title==e&&(o=e,"android"===Ti.Platform.osname=="android"?t.setSelectedRow(0,r,!1):(i.text=o,i.data=a[r]))},t}var Tw=null;Combobox.TUInit=function(e){Tw=e},module.exports=Combobox;