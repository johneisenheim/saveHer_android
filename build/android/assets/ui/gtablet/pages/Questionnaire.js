function Questionnaire(){for(var e=require("ui/gtablet/ui_elements/Buttons"),t=[],i=null,n=null,r=0;9>r;r++)t[r]="";var o=Titanium.UI.createWindow({width:"100%",height:"100%",backgroundColor:"#f8f8f8",navBarHidden:!1,windowSoftInputMode:Titanium.UI.Android.SOFT_INPUT_STATE_HIDDEN,orientationModes:[Titanium.UI.PORTRAIT],title:"Questionario"});o.activity.onCreateOptionsMenu=function(){o.activity.actionBar},o.addEventListener("androidback",function(){Ti.App.fireEvent("report_complete",{}),o.close()});var s=Titanium.UI.createScrollView({width:"100%",height:"100%",backgroundColor:"#f8f8f8",scrollType:"vertical"}),l=Titanium.UI.createView({width:"100%",height:4700,layout:"vertical",top:0,left:0}),u=(Ti.UI.createView({width:"100%",height:"100%",backgroundColor:"transparent",top:0,left:0}),Titanium.UI.createLabel({text:"Grazie!",font:{fontSize:60,fontFamily:"CaviarDreams"},color:"#4F5153",top:10})),c=Titanium.UI.createLabel({text:"La tua segnalazione è andata a buon fine! Ti chiediamo qualche secondo in più: compila questo breve questionario che ci informerà sulla tipologia e causa del danno riscontrato. Questa fase non è obbligatoria, ma ci sarà di grande aiuto per suggerire le azioni di intervento sul bene culturale.",font:{fontSize:24,fontFamily:"CaviarDreams"},color:"#4F5153",textAlign:"center",top:15,width:"95%"}),d=Titanium.UI.createLabel({text:"Che tipo di danno riscontri? E per quali cause?",font:{fontSize:24,fontFamily:"CaviarDreams"},color:"#4F5153",textAlign:"center",top:30,width:"95%"}),f=function(e){var t=Ti.UI.createView({backgroundColor:"#89b47f",height:70}),i=Ti.UI.createLabel({text:e,font:{fontSize:26,fontFamily:"CaviarDreams"},left:5,color:"#fff"});return t.add(i),t},h=Ti.UI.createListView({width:"90%",height:Ti.UI.SIZE,softKeyboardOnFocus:Titanium.UI.Android.SOFT_KEYBOARD_HIDE_ON_FOCUS,top:15}),p=Ti.UI.createListSection({headerView:f("Crolli"),index:0}),m=Ti.UI.createListSection({headerView:f("Lesioni"),index:1}),g=Ti.UI.createListSection({headerView:f("Tetto Sconnesso"),index:2}),T=Ti.UI.createListSection({headerView:f("Degrado e/o caduta materiali"),index:3}),_=Ti.UI.createListSection({headerView:f("Danni sistema raccolte acque"),index:4}),v=Ti.UI.createListSection({headerView:f("Presenza d'acqua"),index:5}),y=Ti.UI.createListSection({headerView:f("Atto vandalico sull'edificio"),index:6}),S=Ti.UI.createListSection({headerView:f("Atto vandalico alle opere d'arte"),index:7}),w=Ti.UI.createListSection({headerView:f("Furto beni immobili"),index:8}),b=[{properties:{title:"Nessuno",accessoryType:Titanium.UI.LIST_ACCESSORY_TYPE_CHECKMARK,backgroundColor:"transparent",isChoosen:!0,font:{fontSize:24,fontFamily:"CaviarDreams"},color:"#4F5153",left:10,height:60}},{properties:{title:"Terremoto",accessoryType:Titanium.UI.LIST_ACCESSORY_TYPE_NONE,backgroundColor:"transparent",isChoosen:!0,font:{fontSize:24,fontFamily:"CaviarDreams"},color:"#4F5153",left:10,height:60}},{properties:{title:"Frana",accessoryType:Titanium.UI.LIST_ACCESSORY_TYPE_NONE,backgroundColor:"transparent",isChoosen:!0,font:{fontSize:24,fontFamily:"CaviarDreams"},color:"#4F5153",left:10,height:60}},{properties:{title:"Incuria",accessoryType:Titanium.UI.LIST_ACCESSORY_TYPE_NONE,backgroundColor:"transparent",isChoosen:!0,font:{fontSize:24,fontFamily:"CaviarDreams"},color:"#4F5153",left:10,height:60}},{properties:{title:"Evento meteorico",accessoryType:Titanium.UI.LIST_ACCESSORY_TYPE_NONE,backgroundColor:"transparent",isChoosen:!0,font:{fontSize:24,fontFamily:"CaviarDreams"},color:"#4F5153",left:10,height:60}},{properties:{title:"Altro",accessoryType:Titanium.UI.LIST_ACCESSORY_TYPE_NONE,backgroundColor:"transparent",isChoosen:!0,font:{fontSize:24,fontFamily:"CaviarDreams"},color:"#4F5153",left:10,height:60}},{properties:{title:"Non so",accessoryType:Titanium.UI.LIST_ACCESSORY_TYPE_NONE,backgroundColor:"transparent",isChoosen:!0,font:{fontSize:24,fontFamily:"CaviarDreams"},color:"#4F5153",left:10,height:60}}],A=[{properties:{title:"Nessuno",accessoryType:Titanium.UI.LIST_ACCESSORY_TYPE_CHECKMARK,backgroundColor:"transparent",isChoosen:!0,font:{fontSize:24,fontFamily:"CaviarDreams"},color:"#4F5153",left:10,height:60}},{properties:{title:"Terremoto",accessoryType:Titanium.UI.LIST_ACCESSORY_TYPE_NONE,backgroundColor:"transparent",isChoosen:!0,font:{fontSize:24,fontFamily:"CaviarDreams"},color:"#4F5153",left:10,height:60}},{properties:{title:"Frana",accessoryType:Titanium.UI.LIST_ACCESSORY_TYPE_NONE,backgroundColor:"transparent",isChoosen:!0,font:{fontSize:24,fontFamily:"CaviarDreams"},color:"#4F5153",left:10,height:60}},{properties:{title:"Incuria",accessoryType:Titanium.UI.LIST_ACCESSORY_TYPE_NONE,backgroundColor:"transparent",isChoosen:!0,font:{fontSize:24,fontFamily:"CaviarDreams"},color:"#4F5153",left:10,height:60}},{properties:{title:"Evento meteorico",accessoryType:Titanium.UI.LIST_ACCESSORY_TYPE_NONE,backgroundColor:"transparent",isChoosen:!0,font:{fontSize:24,fontFamily:"CaviarDreams"},color:"#4F5153",left:10,height:60}},{properties:{title:"Altro",accessoryType:Titanium.UI.LIST_ACCESSORY_TYPE_NONE,backgroundColor:"transparent",isChoosen:!0,font:{fontSize:24,fontFamily:"CaviarDreams"},color:"#4F5153",left:10,height:60}},{properties:{title:"Non so",accessoryType:Titanium.UI.LIST_ACCESSORY_TYPE_NONE,backgroundColor:"transparent",isChoosen:!0,font:{fontSize:24,fontFamily:"CaviarDreams"},color:"#4F5153",left:10,height:60}}],k=[{properties:{title:"Nessuno",accessoryType:Titanium.UI.LIST_ACCESSORY_TYPE_CHECKMARK,backgroundColor:"transparent",isChoosen:!0,font:{fontSize:24,fontFamily:"CaviarDreams"},color:"#4F5153",left:10,height:60}},{properties:{title:"Terremoto",accessoryType:Titanium.UI.LIST_ACCESSORY_TYPE_NONE,backgroundColor:"transparent",isChoosen:!0,font:{fontSize:24,fontFamily:"CaviarDreams"},color:"#4F5153",left:10,height:60}},{properties:{title:"Frana",accessoryType:Titanium.UI.LIST_ACCESSORY_TYPE_NONE,backgroundColor:"transparent",isChoosen:!0,font:{fontSize:24,fontFamily:"CaviarDreams"},color:"#4F5153",left:10,height:60}},{properties:{title:"Incuria",accessoryType:Titanium.UI.LIST_ACCESSORY_TYPE_NONE,backgroundColor:"transparent",isChoosen:!0,font:{fontSize:24,fontFamily:"CaviarDreams"},color:"#4F5153",left:10,height:60}},{properties:{title:"Evento meteorico",accessoryType:Titanium.UI.LIST_ACCESSORY_TYPE_NONE,backgroundColor:"transparent",isChoosen:!0,font:{fontSize:24,fontFamily:"CaviarDreams"},color:"#4F5153",left:10,height:60}},{properties:{title:"Altro",accessoryType:Titanium.UI.LIST_ACCESSORY_TYPE_NONE,backgroundColor:"transparent",isChoosen:!0,font:{fontSize:24,fontFamily:"CaviarDreams"},color:"#4F5153",left:10,height:60}},{properties:{title:"Non so",accessoryType:Titanium.UI.LIST_ACCESSORY_TYPE_NONE,backgroundColor:"transparent",isChoosen:!0,font:{fontSize:24,fontFamily:"CaviarDreams"},color:"#4F5153",left:10,height:60}}],I=[{properties:{title:"Nessuno",accessoryType:Titanium.UI.LIST_ACCESSORY_TYPE_CHECKMARK,backgroundColor:"transparent",isChoosen:!0,font:{fontSize:24,fontFamily:"CaviarDreams"},color:"#4F5153",left:10,height:60}},{properties:{title:"Intonaco",accessoryType:Titanium.UI.LIST_ACCESSORY_TYPE_NONE,backgroundColor:"transparent",isChoosen:!0,font:{fontSize:24,fontFamily:"CaviarDreams"},color:"#4F5153",left:10,height:60}},{properties:{title:"Affreschi",accessoryType:Titanium.UI.LIST_ACCESSORY_TYPE_NONE,backgroundColor:"transparent",isChoosen:!0,font:{fontSize:24,fontFamily:"CaviarDreams"},color:"#4F5153",left:10,height:60}},{properties:{title:"Altro",accessoryType:Titanium.UI.LIST_ACCESSORY_TYPE_NONE,backgroundColor:"transparent",isChoosen:!0,font:{fontSize:24,fontFamily:"CaviarDreams"},color:"#4F5153",left:10,height:60}}],C=[{properties:{title:"Nessuno",accessoryType:Titanium.UI.LIST_ACCESSORY_TYPE_CHECKMARK,backgroundColor:"transparent",isChoosen:!0,font:{fontSize:24,fontFamily:"CaviarDreams"},color:"#4F5153",left:10,height:60}},{properties:{title:"Incuria",accessoryType:Titanium.UI.LIST_ACCESSORY_TYPE_NONE,backgroundColor:"transparent",isChoosen:!0,font:{fontSize:24,fontFamily:"CaviarDreams"},color:"#4F5153",left:10,height:60}},{properties:{title:"Evento meteorico",accessoryType:Titanium.UI.LIST_ACCESSORY_TYPE_NONE,backgroundColor:"transparent",isChoosen:!0,font:{fontSize:24,fontFamily:"CaviarDreams"},color:"#4F5153",left:10,height:60}},{properties:{title:"Altro",accessoryType:Titanium.UI.LIST_ACCESSORY_TYPE_NONE,backgroundColor:"transparent",isChoosen:!0,font:{fontSize:24,fontFamily:"CaviarDreams"},color:"#4F5153",left:10,height:60}},{properties:{title:"Non so",accessoryType:Titanium.UI.LIST_ACCESSORY_TYPE_NONE,backgroundColor:"transparent",isChoosen:!0,font:{fontSize:24,fontFamily:"CaviarDreams"},color:"#4F5153",left:10,height:60}}],D=[{properties:{title:"Nessuno",accessoryType:Titanium.UI.LIST_ACCESSORY_TYPE_CHECKMARK,backgroundColor:"transparent",isChoosen:!0,font:{fontSize:24,fontFamily:"CaviarDreams"},color:"#4F5153",left:10,height:60}},{properties:{title:"Inondazione",accessoryType:Titanium.UI.LIST_ACCESSORY_TYPE_NONE,backgroundColor:"transparent",isChoosen:!0,font:{fontSize:24,fontFamily:"CaviarDreams"},color:"#4F5153",left:10,height:60}},{properties:{title:"Perdita impianti",accessoryType:Titanium.UI.LIST_ACCESSORY_TYPE_NONE,backgroundColor:"transparent",isChoosen:!0,font:{fontSize:24,fontFamily:"CaviarDreams"},color:"#4F5153",left:10,height:60}},{properties:{title:"Infiltrazione dal tetto",accessoryType:Titanium.UI.LIST_ACCESSORY_TYPE_NONE,backgroundColor:"transparent",isChoosen:!0,font:{fontSize:24,fontFamily:"CaviarDreams"},color:"#4F5153",left:10,height:60}},{properties:{title:"Altro",accessoryType:Titanium.UI.LIST_ACCESSORY_TYPE_NONE,backgroundColor:"transparent",isChoosen:!0,font:{fontSize:24,fontFamily:"CaviarDreams"},color:"#4F5153",left:10,height:60}},{properties:{title:"Non so",accessoryType:Titanium.UI.LIST_ACCESSORY_TYPE_NONE,backgroundColor:"transparent",isChoosen:!0,font:{fontSize:24,fontFamily:"CaviarDreams"},color:"#4F5153",left:10,height:60}}],P=[{properties:{title:"Nessuno",accessoryType:Titanium.UI.LIST_ACCESSORY_TYPE_CHECKMARK,backgroundColor:"transparent",isChoosen:!0,font:{fontSize:24,fontFamily:"CaviarDreams"},color:"#4F5153",left:10,height:60}},{properties:{title:"Graffito",accessoryType:Titanium.UI.LIST_ACCESSORY_TYPE_NONE,backgroundColor:"transparent",isChoosen:!0,font:{fontSize:24,fontFamily:"CaviarDreams"},color:"#4F5153",left:10,height:60}},{properties:{title:"Scritte",accessoryType:Titanium.UI.LIST_ACCESSORY_TYPE_NONE,backgroundColor:"transparent",isChoosen:!0,font:{fontSize:24,fontFamily:"CaviarDreams"},color:"#4F5153",left:10,height:60}},{properties:{title:"Affissione manifesti",accessoryType:Titanium.UI.LIST_ACCESSORY_TYPE_NONE,backgroundColor:"transparent",isChoosen:!0,font:{fontSize:24,fontFamily:"CaviarDreams"},color:"#4F5153",left:10,height:60}},{properties:{title:"Azione meccanica",accessoryType:Titanium.UI.LIST_ACCESSORY_TYPE_NONE,backgroundColor:"transparent",isChoosen:!0,font:{fontSize:24,fontFamily:"CaviarDreams"},color:"#4F5153",left:10,height:60}},{properties:{title:"Fuoco",accessoryType:Titanium.UI.LIST_ACCESSORY_TYPE_NONE,backgroundColor:"transparent",isChoosen:!0,font:{fontSize:24,fontFamily:"CaviarDreams"},color:"#4F5153",left:10,height:60}},{properties:{title:"Esplosione",accessoryType:Titanium.UI.LIST_ACCESSORY_TYPE_NONE,backgroundColor:"transparent",isChoosen:!0,font:{fontSize:24,fontFamily:"CaviarDreams"},color:"#4F5153",left:10,height:60}},{properties:{title:"Altro",accessoryType:Titanium.UI.LIST_ACCESSORY_TYPE_NONE,backgroundColor:"transparent",isChoosen:!0,font:{fontSize:24,fontFamily:"CaviarDreams"},color:"#4F5153",left:10,height:60}}],E=[{properties:{title:"Nessuno",accessoryType:Titanium.UI.LIST_ACCESSORY_TYPE_CHECKMARK,backgroundColor:"transparent",isChoosen:!0,font:{fontSize:24,fontFamily:"CaviarDreams"},color:"#4F5153",left:10,height:60}},{properties:{title:"Graffito",accessoryType:Titanium.UI.LIST_ACCESSORY_TYPE_NONE,backgroundColor:"transparent",isChoosen:!0,font:{fontSize:24,fontFamily:"CaviarDreams"},color:"#4F5153",left:10,height:60}},{properties:{title:"Scritte",accessoryType:Titanium.UI.LIST_ACCESSORY_TYPE_NONE,backgroundColor:"transparent",isChoosen:!0,font:{fontSize:24,fontFamily:"CaviarDreams"},color:"#4F5153",left:10,height:60}},{properties:{title:"Affissione manifesti",accessoryType:Titanium.UI.LIST_ACCESSORY_TYPE_NONE,backgroundColor:"transparent",isChoosen:!0,font:{fontSize:24,fontFamily:"CaviarDreams"},color:"#4F5153",left:10,height:60}},{properties:{title:"Azione meccanica",accessoryType:Titanium.UI.LIST_ACCESSORY_TYPE_NONE,backgroundColor:"transparent",isChoosen:!0,font:{fontSize:24,fontFamily:"CaviarDreams"},color:"#4F5153",left:10,height:60}},{properties:{title:"Fuoco",accessoryType:Titanium.UI.LIST_ACCESSORY_TYPE_NONE,backgroundColor:"transparent",isChoosen:!0,font:{fontSize:24,fontFamily:"CaviarDreams"},color:"#4F5153",left:10,height:60}},{properties:{title:"Esplosione",accessoryType:Titanium.UI.LIST_ACCESSORY_TYPE_NONE,backgroundColor:"transparent",isChoosen:!0,font:{fontSize:24,fontFamily:"CaviarDreams"},color:"#4F5153",left:10,height:60}},{properties:{title:"Altro",accessoryType:Titanium.UI.LIST_ACCESSORY_TYPE_NONE,backgroundColor:"transparent",isChoosen:!0,font:{fontSize:24,fontFamily:"CaviarDreams"},color:"#4F5153",left:10,height:60}}],O=[{properties:{title:"Nessuno",accessoryType:Titanium.UI.LIST_ACCESSORY_TYPE_CHECKMARK,backgroundColor:"transparent",isChoosen:!0,font:{fontSize:24,fontFamily:"CaviarDreams"},color:"#4F5153",left:10,height:60}},{properties:{title:"Arredi",accessoryType:Titanium.UI.LIST_ACCESSORY_TYPE_NONE,backgroundColor:"transparent",isChoosen:!0,font:{fontSize:24,fontFamily:"CaviarDreams"},color:"#4F5153",left:10,height:60}},{properties:{title:"Opere d'arte",accessoryType:Titanium.UI.LIST_ACCESSORY_TYPE_NONE,backgroundColor:"transparent",isChoosen:!0,font:{fontSize:24,fontFamily:"CaviarDreams"},color:"#4F5153",left:10,height:60}},{properties:{title:"Altro",accessoryType:Titanium.UI.LIST_ACCESSORY_TYPE_NONE,backgroundColor:"transparent",isChoosen:!0,font:{fontSize:24,fontFamily:"CaviarDreams"},color:"#4F5153",left:10,height:60}}];p.setItems(b),m.setItems(A),g.setItems(k),T.setItems(I),_.setItems(C),v.setItems(D),y.setItems(P),S.setItems(E),w.setItems(O);var M=function(e){switch(e){case 0:return"Crolli";case 1:return"Lesioni";case 2:return"Tetto Sconnesso";case 3:return"Degrado e/o caduta materiali";case 4:return"Danni sistema raccolte acque";case 5:return"Presenza d'acqua";case 6:return"Atto vandalico sull'edificio";case 7:return"Atto vandalico alle opere d'arte";case 8:return"Furto beni immobili"}};h.addEventListener("itemclick",function(e){var i=e.section.getItemAt(e.itemIndex),n=e.section.getItems().length;if(Ti.API.info(n),i.properties.accessoryType==Ti.UI.LIST_ACCESSORY_TYPE_NONE){i.properties.accessoryType=Ti.UI.LIST_ACCESSORY_TYPE_CHECKMARK,t[e.itemIndex]="Nessuno"!==i.properties.title?i.properties.title:"";for(var a=0;n>a;a++)if(a!=e.itemIndex){var r=e.section.getItemAt(a);r.properties.accessoryType=Ti.UI.LIST_ACCESSORY_TYPE_NONE,e.section.updateItemAt(a,r)}}e.section.updateItemAt(e.itemIndex,i)});var F=e();F.setButtonTitle("Invia!"),F.setButtonTop(15),F.addEventListener("click",function(){F.setButtonTitle("Attendi...");for(var e="",r="{",s=0;s<t.length;s++)""!==t[s]&&(r+='"'+M(s)+'":"'+t[s]+'",',Ti.API.info(M(s)));if(r=r.substr(0,r.length-1),r+="}",Ti.API.info(r),(""==Y.value||"Ulteriori informazioni..."==Y.value)&&r.length<=1)return F.setButtonTitle("Invia!"),Ti.App.fireEvent("report_complete",{}),void o.close();(""!=Y.value||"Ulteriori informazioni..."!=Y.value)&&(e=Y.value);var l=Titanium.Network.createHTTPClient({onload:function(){Ti.API.info(this.responseText);var e=JSON.parse(this.responseText);e.response?(F.setButtonTitle("Fatto!"),Ti.App.fireEvent("report_complete",{}),setTimeout(function(){o.close()},3e3)):(a.setMessage("C'è stato un errore nell'invio della richiesta. Ti preghiamo di riprovare più tardi!"),a.show(),donebutton.setButtonTitle("Invia!"))},onerror:function(){a.setMessage("C'è stato un errore nell'invio della richiesta. Ti preghiamo di riprovare più tardi!"),a.show(),F.setButtonTitle("Invia!")}});l.open("POST","http://www.appsaveheritage.com/memquest.php");var u={userid:n,id:i};u.quest=r.length>1?r:"",u.more=""!=Y.value?e:"",Ti.API.info(JSON.stringify(u)),l.send(u)}),h.sections=[p,m,g,T,_,v,y,S,w];var Y=Ti.UI.createTextArea({borderWidth:0,color:"#4F5153",backgroundColor:"#f8f8f8",font:{fontSize:24,fontFamily:"CaviarDreams"},returnKeyType:Titanium.UI.RETURNKEY_DONE,textAlign:"left",hintText:"Ulteriori informazioni...",top:20,width:"95%",autocorrect:!0,autocapitalization:Titanium.UI.TEXT_AUTOCAPITALIZATION_SENTENCES,verticalAlign:Titanium.UI.TEXT_VERTICAL_ALIGNMENT_TOP,height:150});o.openWin=function(e,t){i=e,n=t,o.open(),setTimeout(function(){s.scrollTo(0,0)},500)};var U=Ti.UI.createView({width:1,height:15,top:5});return l.add(u),l.add(c),l.add(d),l.add(h),l.add(Y),l.add(F),l.add(U),s.add(l),o.add(s),o}module.exports=Questionnaire;