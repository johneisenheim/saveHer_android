function PickerPopup(e,t,n){var r=null,i=t,a="",o=-1,s=n,u=null,l=null,c=null,d=null;if(r=Ti.UI.createWindow({backgroundColor:"white",layout:"vertical"}),!s){var h=Titanium.UI.create2DMatrix();h=h.scale(0),r.fullscreen=!1,r.top=25,r.backgroundColor="transparent",r.width=Ti.UI.FILL,r.height=Ti.UI.SIZE,r.opacity=1,r.navBarHidden=!0,r.bottom=25}l=Ti.UI.createButton({title:L("cancel"),height:25,top:2,left:20}),c=Ti.UI.createButton({title:L("selected"),height:25,top:2,right:20});var f=Ti.UI.createButton({systemButton:Ti.UI.iPhone.SystemButton.FLEXIBLE_SPACE});d=Ti.UI.iOS.createToolbar({items:[l,f,c],backgroundColor:"#777",top:0,borderTop:!1,borderBottom:!0}),s&&r.add(d);for(var p=[],m=!1,g=0,v=0;v<i.length;v++)"exclude"==i[v].value&&(m=!0,g++),"exclude"!=i[v].value&&p.push({title:i[v].title});var T=Ti.UI.createView({left:0,right:0,bottom:0,height:Ti.UI.FILL});u=Ti.UI.createTableView({data:p,borderWidth:1,borderColor:"#000",borderRadius:5,left:5,right:5,allowSelection:!0,height:Ti.UI.SIZE});var _;return u.addEventListener("click",function(e){s?e.row.hasCheck?(e.row.hasCheck=!1,e.row.backgroundColor="white"):(e.row.hasCheck=!0,e.row.backgroundColor="#ff6600"):(e.row.backgroundColor="#ff6600",e.row.hasCheck=!0,_&&_!=e.row&&(_.hasCheck=!1,_.backgroundColor="white")),r.xsetValue(m?i[e.index+g]:i[e.index]),s||(_=e.row,r.fireEvent("done",{value:a}),r.close())}),r.add(T),T.add(u),c.addEventListener("click",function(){r.fireEvent("done",{value:a}),r.close()}),l.addEventListener("click",function(){r.close()}),r.xsetValue=function(e){o>-1&&u.deselectRow(o);for(var t=0;t<i.length;t++)if(i[t].title==e){o=t,u.selectRow(o),u.scrollToIndex(o);break}a=e},r}function Combobox(e){var t=null,n=null,r=[],i="",a=!1,o=[],s="",u=null,l=L("select"),c=null,d="true",h={};e.labelSelect?l=e.labelSelect:"boolean"==typeof e.labelSelect&&(e.labelSelect||(d=e.labelSelect));var f={title:l,value:"exclude"};for(var p in e)"values"!=p?"title"!=p?h[p]=e[p]:s=e[p]:(d&&e[p].unshift(f),r=e[p]);e.multiple&&(a=e.multiple),r.length>0&&("number"==typeof e.selectedValueIndex?i=r[e.selectedValueIndex]:d&&(i=r[0]));for(var m=0,g=0;g<r.length;g++)o.push(Ti.UI.createPickerRow({title:r[g].title,data:r[g]})),"exclude"!=r[g].value&&m++;if("android"===Ti.Platform.osname)"undefined"!=typeof h.backgroundColor&&delete h.backgroundColor,t=Ti.UI.createPicker(h),t.addEventListener("change",function(e){i=e.selectedValue[0],t.fireEvent("TwChange",{value:t.getSelectedRow(0).data.value})}),t.add(o);else{"undefined"==typeof h.height&&(h.height=35),"undefined"==typeof h.borderColor&&(h.borderColor="#999"),"undefined"==typeof h.borderRadius&&(h.borderRadius=5),"undefined"==typeof h.backgroundColor&&(h.backgroundColor="#fff"),"undefined"==typeof h.font&&(h.font={fontSize:30,fontWeight:"bold"}),"undefined"==typeof h.color&&(h.color="#385487"),t=Ti.UI.createView(h);var v={left:"10dp",top:"11dp",color:h.color,font:h.font,text:i.title,data:i};n=Ti.UI.createLabel(v);var T=Ti.UI.create2DMatrix();c=Ti.UI.createButton({right:5,style:Ti.UI.iPhone.SystemButton.DISCLOSURE,transform:T,backgroundImage:"/widget/arrow.png"}),0==m&&(n.text="Sin Informacion"),t.add(n),t.add(c),t.addEventListener("click",function(){m>0&&(u=new PickerPopup(s,r,a),u.addEventListener("done",function(e){e.value!=i&&(i=e.value,n.text=i.title,n.data=i,e.data=n.data,t.fireEvent("TwChange",e))}),u.xsetValue(i),u.backgroundColor="rgba(51, 204, 255, 0.28)",u.open())})}return t.xgetValue=function(){return i},t.xsetValue=function(e){for(var a=0;a<r.length;a++)r[a].title==e&&(i=e,"android"===Ti.Platform.osname=="android"?t.setSelectedRow(0,a,!1):(n.text=i,n.data=r[a]))},t}var Tw=null;Combobox.TUInit=function(e){Tw=e},module.exports=Combobox;