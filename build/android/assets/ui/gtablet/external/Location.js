function Location(){var e=require("external/moment"),t={};t.isGPSRunning=!1,Ti.Geolocation.Android.manualMode=!0;var i=new Date;t.hasGPSDone=!1;var r=-1;gpsProvider=Ti.Geolocation.Android.createLocationProvider({name:Ti.Geolocation.PROVIDER_GPS,minUpdateTime:60,minUpdateDistance:150}),Ti.Geolocation.Android.addLocationProvider(gpsProvider);var n=(Ti.UI.createAlertDialog({message:"",ok:"Ok",title:"saveHer"}),function(a){t.isGPSRunning=!0;try{if(a.success&&"undefined"!=typeof a.coords.latitude&&"undefined"!=typeof a.coords.longitude){if(r=e(i).diff(new Date(a.coords.timestamp),"minute"),3>=r&&a.coords.accuracy<150){{a.coords.latitude,a.coords.longitude}Ti.App.fireEvent("gps_event",{accuracy:a.coords.accuracy,latitude:a.coords.latitude,longitude:a.coords.longitude,timestamp:!0}),Ti.API.info("Location is "+a.coords.latitude+","+a.coords.longitude),t.isGPSRunning=!1,Titanium.Geolocation.removeEventListener("location",n),t.hasGPSDone=!0}Ti.API.info(a.coords.latitude+","+a.coords.longitude),Ti.API.info("Now is "+i),Ti.API.info("From coords "+new Date(a.coords.timestamp))}}catch(o){Ti.App.fireEvent("disable_gps",{})}});return t.startGPS=function(){Titanium.Geolocation.getLocationServicesEnabled()?(t.gpsEnabled=!0,Ti.API.info("gpsenabled"),Ti.Geolocation.addEventListener("location",n)):(t.gpsEnabled=!1,Ti.API.info("gpsdisabled"))},t.getGPSRunning=function(){return t.isGPSRunning},t.removeGPSEvent=function(){t.isGPSRunning&&(Titanium.Geolocation.removeEventListener("location",n),Ti.API.info("removeGPSEvent"))},t}module.exports=Location;